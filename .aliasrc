# Aliases

alias v='vim'
alias vd='vimdiff'
alias nmap='grc nmap'
alias ping='grc ping'
alias ls='ls --color=auto --group-directories-first'
alias src='cd /usr/local/src/'
alias web='cd ~/dox/github/matesz44.github.io/'
alias htb='cd ~/hax/wargames/htb && tree $(pwd) -L 2'
alias pyhttp='sudo python3 -m http.server 80'
alias impacket='cd /usr/share/doc/python3-impacket/examples/'


#1337 H4XxX0R 4L14535

#----- recon -----
crtndstry(){
~/tools/crtndstry/crtndstry $1
}

certspotter(){
curl -s https://certspotter.com/api/v0/certs\?domain\=$1 | jq '.[].dns_names[]' | sed 's/\"//g' | sed 's/\*\.//g' | sort -u | grep $1
}

crtsh(){
curl -s https://crt.sh/?q\=%.$1\&output\=json | jq -r '.[].name_value' | sed 's/\*\.//g' | sort -u
}

certnmap(){
curl https://certspotter.com/api/v0/certs\?domain\=$1 | jq '.[].dns_names[]' | sed 's/\"//g' | sed 's/\*\.//g' | sort -u | grep $1  | nmap -T5 -Pn -sS -i - -$
}

ipinfo(){
curl http://ipinfo.io/$1
}


#------ Tools ------
dirsearch_ext(){
python3 /opt/dirsearch/dirsearch.py -u $1 -e $2 -t 50 -b
} #runs dirsearch and takes host and extension as arguments

ncx(){
rlwrap nc -l -n -vv -p $1
}

crtshdirsearch(){
curl -s https://crt.sh/?q\=%.$1\&output\=json | jq -r '.[].name_value' | sed 's/\*\.//g' | sort -u | httprobe -c 50 | grep https | xargs -n1 -I{} python3 ~/tools/dirsearch/dirsearch.py -u {} -e $2 -t 50 -b
} #gets all domains from crtsh, runs httprobe and then dir bruteforcers


## Directory/file fuzzing
dsearch_med(){
python3 /opt/dirsearch/dirsearch.py -u $1 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -e $2 -t 50
}
dsearch_comm(){
python3 /opt/dirsearch/dirsearch.py -u $1 -w /usr/share/wordlists/dirb/common.txt -e $2 -t 50
}

ffuf_med(){
ffuf -u $1 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 80
}
ffuf_comm(){
ffuf -u $1 -w /usr/share/wordlists/dirb/common.txt -t 80
}
